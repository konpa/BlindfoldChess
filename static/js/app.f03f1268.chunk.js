(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{226:function(e,t,n){"use strict";n.d(t,"a",(function(){return re}));var r=n(0),c=n(338),o=n(339),i=n(2),a=n.n(i),s=n(335),l=n(336),u=n(127),j=n(340),b=n(215),d=n(318),h=n(85),O=n(37),f=n(101),x=n(227),p=n(331),m=n(332),g=n(134),y=n(157),v=n(140),S=n(57),w=n(337),k=n(341),P=n(3),C=n.n(P),I=n(1),N=n.n(I),L=n(5),z=n(78),E=n(104),G=n(141),A=n(187),D=n.n(A),_=n(110),W=n.n(_),M=n(10),T=L.a.select({web:!1,default:!0}),B=L.a.select({web:Object(E.b)({useProxy:T}),default:Object(E.b)({useProxy:T})});z.b();var J="https://lichess.org",R={authorizationEndpoint:J+"/oauth",tokenEndpoint:J+"/api/token"},U=Object(r.createContext)({});function H(e){var t=e.children,n=Object(r.useState)(null),c=C()(n,2),o=c[0],i=c[1],a=Object(r.useState)(!1),s=C()(a,2),l=s[0],u=s[1],j=Object(r.useState)(null),b=C()(j,2),d=b[0],h=b[1],O=Object(E.c)({clientId:"io.blindfoldchess",redirectUri:B,scopes:["challenge:write","bot:play","board:play"]},R),f=C()(O,3),x=f[0],p=f[1],m=f[2];Object(r.useEffect)((function(){function e(){var e;"success"===(null==p?void 0:p.type)&&(e=p.params.code,Object(E.a)({clientId:"io.blindfoldchess",code:e,redirectUri:B,extraParams:{code_verifier:null!=x&&x.codeVerifier?x.codeVerifier:""}},R).then((function(e){var t={token:e};G.a.setItem("@AuthData",JSON.stringify(t)),i(t)})).catch((function(e){h(e)}))),"error"===(null==p?void 0:p.type)&&h(null!=p&&p.error?p.error:null)}u(!0),G.a.getItem("@AuthData").then((function(t){t?i(JSON.parse(t)):e()})),u(!1)}),[p,x]);var g=Object(r.useMemo)((function(){return{user:o,setUser:i,error:d,setError:h,isLoading:l,login:function(){u(!0),m({useProxy:T}),u(!1)},logout:function(){return N.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:u(!0),D()({method:"delete",url:J+"/api/token",headers:{Authorization:"Bearer "+(null==o?void 0:o.token.accessToken)}}).then((function(){return N.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.awrap(G.a.removeItem("@AuthData"));case 2:i(null),u(!1);case 4:case"end":return e.stop()}}),null,null,null,Promise)})).catch((function(e){h(e),u(!1)}));case 2:case"end":return e.stop()}}),null,null,null,Promise)}}}),[o,d,l,m]);return Object(M.jsx)(U.Provider,{value:g,children:t})}H.propTypes={children:W.a.element.isRequired};var V=n(343),q=n(342);function Y(){var e=Object(r.useContext)(U),t=e.login,n=e.isLoading;return Object(M.jsxs)(O.a,{alignItems:"center",justifyContent:"center",flex:1,p:"5",_dark:{bg:"light.800"},children:[Object(M.jsx)(p.a,{size:"lg",style:{textTransform:"uppercase"},_dark:{color:"light.300"},children:"Blindfold Chess"}),Object(M.jsxs)(S.a,{mb:"16",_dark:{color:"light.300"},children:["Powered by",Object(M.jsx)(V.a,{href:"lichess.org",ml:"1",children:"lichess.org"})]}),Object(M.jsx)(q.a,{onPress:function(){return t()},mt:"2",w:"100%",maxW:"300",isLoading:n,colorScheme:"amber",children:"SIGN IN"}),Object(M.jsx)(S.a,{mt:"2",fontSize:"xs",_dark:{color:"light.300"},children:"Sign in with your lichess account"})]})}function F(e){var t=e.navigation;return Object(M.jsx)(O.a,{position:"absolute",bottom:"0",left:"0",right:"0",py:"3",children:Object(M.jsx)(m.a,{children:Object(M.jsx)(g.a,{space:3,w:"90%",maxW:"400",children:Object(M.jsx)(q.a,{onPress:function(){return t.navigate("CreateGame")},colorScheme:"amber",children:"NEW GAME"})})})})}var K=n(333);function Q(){return Object(M.jsxs)(K.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[Object(M.jsx)(S.a,{children:"Create New Game"}),Object(M.jsx)(q.a,{mt:"2",w:"100%",maxW:"300",colorScheme:"amber",children:"PLAY"})]})}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=Object(j.a)();function ee(){var e=Object(r.useContext)(U).logout;return Object(M.jsx)(b.a,{onPress:function(){return e()},icon:Object(M.jsx)(d.a,{as:k.a,name:"logout",size:"sm",_dark:{color:"light.300"}}),colorScheme:"amber"})}function te(){var e=Object(r.useContext)(U),t=e.user,n=e.isLoading,c=e.error,o=Object(h.b)().colorMode,i=Z(Z({},s.a),{},{colors:Z(Z({},s.a.colors),{},{background:"rgb(41, 37, 36)",card:"rgb(28, 25, 23)"})});return n?Object(M.jsx)(O.a,{alignItems:"center",justifyContent:"center",flex:1,_dark:{bg:"light.800"},children:Object(M.jsxs)(f.a,{space:2,justifyContent:"center",children:[Object(M.jsx)(x.a,{accessibilityLabel:"Loading",color:"amber.500"}),Object(M.jsx)(p.a,{color:"amber.500",fontSize:"md",children:"Loading"})]})}):Object(M.jsxs)(l.a,{theme:"dark"===o?i:u.a,children:[null==t?Object(M.jsx)($.Navigator,{initialRouteName:"SignIn",children:Object(M.jsx)($.Screen,{name:"SignIn",component:Y,options:{title:"Log In - Blindfold Chess",headerShown:!1}})}):Object(M.jsxs)($.Navigator,{initialRouteName:"Home",screenOptions:{headerTitleStyle:{fontWeight:"bold"},headerTitleAlign:"center",headerRight:ee},children:[Object(M.jsx)($.Screen,{name:"Home",component:F,options:{title:"Blindfold Chess"}}),Object(M.jsx)($.Screen,{name:"CreateGame",component:Q,options:{title:"New Game"}})]}),c&&Object(M.jsx)(O.a,{position:"absolute",bottom:"0",left:"0",right:"0",py:"3",children:Object(M.jsx)(m.a,{children:Object(M.jsx)(g.a,{space:3,w:"90%",maxW:"400",children:Object(M.jsx)(y.a,{w:"100%",status:"error",variant:"left-accent",children:Object(M.jsx)(v.a,{space:2,flexShrink:1,w:"100%",children:Object(M.jsxs)(f.a,{flexShrink:1,space:2,justifyContent:"space-between",children:[Object(M.jsxs)(f.a,{space:2,flexShrink:1,children:[Object(M.jsx)(y.a.Icon,{mt:"1"}),Object(M.jsx)(S.a,{fontSize:"md",color:"coolGray.800",children:c.toString()})]}),Object(M.jsx)(b.a,{variant:"unstyled",icon:Object(M.jsx)(w.a,{size:"3",color:"coolGray.600"})})]})})})})})})]})}var ne=Object(c.a)({config:{useSystemColorMode:!0,initialColorMode:"light"}});function re(){return Object(M.jsx)(o.a,{theme:ne,children:Object(M.jsx)(H,{children:Object(M.jsx)(te,{})})})}},235:function(e,t,n){e.exports=n(315)},254:function(e,t){}},[[235,1,2]]]);
//# sourceMappingURL=app.f03f1268.chunk.js.map